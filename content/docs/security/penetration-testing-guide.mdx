---
title: Penetration Testing Guide
description: Complete penetration testing guide for VQuest Platform
---

# Penetration Testing Guide - VQuest Platform

## 1. Environment Setup

### Requirements
```bash
# Install tools
npm install -g @lhci/cli  # Lighthouse CI
npm install -g snyk       # Security vulnerabilities scanner

# Docker for isolated tools
docker pull owasp/zap2docker-stable
docker pull aquasec/trivy
```

## 2. Automated Tests

### A. Dependency Vulnerabilities

```bash
# Snyk - Scan node_modules
snyk test

# NPM Audit
npm audit

# PNPM Audit (if using pnpm)
pnpm audit

# Verify known CVEs
npm audit --json > audit-report.json
```

### B. Static Code Analysis (SAST)

```bash
# ESLint with security plugins
npm install --save-dev eslint-plugin-security

# Add to .eslintrc.json
{
  "plugins": ["security"],
  "extends": ["plugin:security/recommended"]
}

# Execute
npx eslint . --ext .ts,.tsx,.js,.jsx
```

### C. Web Scanning with OWASP ZAP

```bash
# Baseline scan (passive, safe)
docker run -t owasp/zap2docker-stable zap-baseline.py \
  -t https://staging.vquest.xyz \
  -r zap-report.html

# Full scan (active, may affect)
docker run -t owasp/zap2docker-stable zap-full-scan.py \
  -t https://staging.vquest.xyz \
  -r zap-full-report.html
```

### D. API Security Tests

```bash
# Install
npm install -g newman

# Create Postman collection with tests
# Execute
newman run pentesting-collection.json -e production.json
```

## 3. Critical Manual Tests

### A. Authentication

**Test 1: Login Bypass**
```bash
# Attempt access without token
curl https://api.vquest.xyz/api/admin/users \
  -H "Content-Type: application/json"

# Expected: 401 Unauthorized
```

**Test 2: JWT Manipulation**
```bash
# Decode JWT
echo "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." | base64 -d

# Attempt to change role to SUPER_ADMIN
# Expected: Signature verification failed
```

**Test 3: Session Fixation**
```bash
# Attempt to reuse expired token
# Expected: 401 Unauthorized
```

### B. Authorization (RBAC)

**Test 4: Privilege Escalation**
```typescript
// As END_USER, attempt:
POST /api/admin/users/create
POST /api/companies/create

// Expected: 403 Forbidden
```

**Test 5: Multi-tenant Isolation**
```typescript
// User from Company A attempts to access Company B data
GET /api/campaigns/{campaignId_from_another_company}

// Expected: 404 Not Found or 403 Forbidden
```

### C. Injection

**Test 6: SQL Injection (Prisma should protect)**
```bash
# Attempt in query params
GET /api/users?email=' OR '1'='1

# Attempt in body
POST /api/auth/signin
{
  "email": "admin' OR '1'='1--",
  "password": "anything"
}

# Expected: Validation error, not SQL error
```

**Test 7: NoSQL Injection**
```bash
POST /api/campaigns
{
  "title": { "$gt": "" }
}

# Expected: Validation rejects objects
```

**Test 8: XSS (Stored)**
```bash
POST /api/campaigns
{
  "title": "<script>alert('XSS')</script>",
  "description": "<img src=x onerror=alert('XSS')>"
}

# Expected: Automatic escaping by React
```

### D. Rate Limiting

**Test 9: Brute Force Protection**
```bash
# Attempt 100 logins in 1 minute
for i in {1..100}; do
  curl -X POST https://api.vquest.xyz/api/auth/signin \
    -d '{"email":"test@test.com","password":"wrong"}' &
done

# Expected: 429 Too Many Requests after N attempts
```

**Test 10: API Rate Limiting**
```bash
# Spam protected endpoint
for i in {1..200}; do
  curl https://api.vquest.xyz/api/gems/balance \
    -H "Authorization: Bearer $TOKEN" &
done

# Expected: 429 after configured limit
```

### E. CAPTCHA Bypass

**Test 11: Registration without CAPTCHA**
```bash
POST /api/auth/register
{
  "email": "bot@test.com",
  "password": "password123",
  "captchaToken": ""  # No token
}

# Expected: 400 Bad Request
```

**Test 12: Reused CAPTCHA**
```bash
# Use same token twice
# Expected: 'invalid-or-already-seen-response'
```

### F. Crypto/Payments

**Test 13: Double Spending**
```bash
# Attempt to use same txHash twice
POST /api/gamepass/confirm
{
  "transactionId": "tx_already_used"
}

# Expected: 400 "Transaction already processed"
```

**Test 14: Price Manipulation**
```bash
# Attempt to modify price in request
POST /api/gamepass/purchase
{
  "gamePassId": "xxx",
  "cryptoAmount": "0.0001",  # Lower than real
  "cryptoCurrency": "BTC"
}

# Expected: Server validates real price
```

### G. File Upload

**Test 15: Malicious File Upload**
```bash
# Attempt to upload .exe, .sh, .php
POST /api/upload
Content-Type: multipart/form-data

# Expected: MIME type validation
```

**Test 16: Path Traversal**
```bash
POST /api/upload
{
  "filename": "../../etc/passwd"
}

# Expected: Path sanitization
```

### H. Business Logic

**Test 17: Negative Gems**
```bash
POST /api/gems/spend
{
  "amount": -1000  # Attempt to "spend" negative = gain
}

# Expected: Validation rejects negatives
```

**Test 18: Activity Re-submission**
```bash
# Complete activity twice to duplicate reward
POST /api/activities/{id}/submit
# (repeat immediately)

# Expected: Unique constraint [userId, activityId]
```

**Test 19: Referral Loop**
```bash
# User A refers B, B refers A
# Expected: Validation prevents loops
```

## 4. Infrastructure Tests

### A. Security Headers

```bash
curl -I https://vquest.xyz

# Verify headers:
# âœ… Strict-Transport-Security
# âœ… X-Content-Type-Options: nosniff
# âœ… X-Frame-Options: DENY
# âœ… Content-Security-Policy
# âœ… Referrer-Policy
```

### B. SSL/TLS

```bash
# SSLLabs scan
https://www.ssllabs.com/ssltest/analyze.html?d=vquest.xyz

# Expected: A or A+
```

### C. DNS Security

```bash
# Verify DNSSEC
dig +dnssec vquest.xyz

# Verify SPF/DKIM/DMARC for emails
dig TXT vquest.xyz
```

## 5. Recommended Tools

### Automated Scanners
```bash
# OWASP ZAP
docker run -t owasp/zap2docker-stable zap-baseline.py -t https://vquest.xyz

# Nikto
nikto -h https://vquest.xyz -ssl

# Nmap (port scanning)
nmap -sV -sC vquest.xyz

# Wappalyzer (tech stack detection)
# https://www.wappalyzer.com/
```

### Code Analysis
```bash
# Semgrep (SAST)
semgrep --config=auto .

# CodeQL (GitHub Advanced Security)
# Enable in GitHub repository

# SonarQube
docker run -d --name sonarqube -p 9000:9000 sonarqube
```

### Dependency Scanning
```bash
# Snyk
snyk test
snyk monitor

# Trivy (containers)
docker run aquasec/trivy image node:20-alpine

# Dependabot (GitHub)
# Enable in Settings > Security
```

## 6. Pentesting Checklist

### Pre-Test
- [ ] Staging environment ready
- [ ] Database backup
- [ ] Test users created
- [ ] Rate limits temporarily relaxed
- [ ] Enhanced logging

### During Test
- [ ] SQL Injection attempts
- [ ] XSS attempts (stored, reflected, DOM)
- [ ] CSRF protection
- [ ] Authentication bypass
- [ ] Authorization/RBAC bypass
- [ ] Session management
- [ ] Rate limiting effectiveness
- [ ] CAPTCHA bypass attempts
- [ ] File upload validation
- [ ] API security
- [ ] Business logic flaws
- [ ] Crypto/payment manipulation
- [ ] Multi-tenant isolation

### Post-Test
- [ ] Generate findings report
- [ ] Classify by severity (Critical, High, Medium, Low)
- [ ] Create tickets for each vulnerability
- [ ] Re-test after fixes
- [ ] Update security documentation

## 7. Vulnerability Reporting

### Finding Template

```markdown
# VULN-001: [Vulnerability Title]

## Severity
ðŸ”´ Critical / ðŸŸ  High / ðŸŸ¡ Medium / ðŸŸ¢ Low

## Description
[What the vulnerability is]

## Impact
[What an attacker can do]

## Steps to Reproduce
1. Go to...
2. Do...
3. Observe...

## Proof of Concept (PoC)
```bash
curl -X POST https://api.vquest.xyz/endpoint \
  -d '{"malicious": "payload"}'
```

## Remediation
[How to fix it]

## References
- OWASP: https://...
- CWE: https://...
```

## 8. Suggested Timeline

### Phase 1: Automated Scans (1-2 days)
- Dependency scanning (npm audit, snyk)
- SAST (ESLint security, Semgrep)
- DAST (OWASP ZAP baseline)

### Phase 2: Manual Testing (3-5 days)
- Authentication/Authorization
- Injection attacks
- Business logic
- API security

### Phase 3: Infrastructure (1 day)
- SSL/TLS
- Headers
- DNS
- Server configuration

### Phase 4: Reporting (1 day)
- Compile findings
- Classify severities
- Write recommendations

**Total: 1-2 weeks** (depending on depth)

## 9. Estimated Costs

### DIY (Yourself)
- Time: 1-2 weeks
- Cost: $0 (open source tools)
- Coverage: 60-70%

### Paid Tools
- Snyk Pro: ~$50-100/month
- OWASP ZAP + Nuclei: Free
- Total: ~$100/month

### Professional Pentesting
- Junior consultancy: $2,000-5,000
- Mid-tier (Cobalt, Synack): $5,000-10,000
- Enterprise (Big4): $15,000-50,000+

### Recommendation
**Hybrid**:
1. DIY automated scans (free)
2. Critical manual testing (yourself)
3. External review every 6-12 months ($3k-5k)

## 10. Resources

### Learning
- [OWASP Web Security Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [PortSwigger Web Security Academy](https://portswigger.net/web-security)
- [HackTheBox](https://www.hackthebox.com/)

### Tools
- [OWASP ZAP](https://www.zaproxy.org/)
- [Burp Suite Community](https://portswigger.net/burp/communitydownload)
- [Nuclei](https://github.com/projectdiscovery/nuclei)

### Communities
- [r/netsec](https://reddit.com/r/netsec)
- [BugBountyForum](https://bugbountyforum.com/)
- [HackerOne Hacktivity](https://hackerone.com/hacktivity)
